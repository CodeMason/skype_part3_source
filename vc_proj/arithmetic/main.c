#include <stdio.h>
#include <stdlib.h>

extern unsigned long unpack (void *inptr, unsigned long inlength, void *outptr);

/*
static char buf[]=
"\x42\xF6\x43\x86\x86\x4D\x23\xB8\xB4\xED\xEB\x3B"
"\xFF\xE1\x81\x6A\xB1\x66\x2C\xE6\x97\x9A\xA0\xB8\xC4\x17\x84\x87\xE2\x32"
;
//I:0x00000002 D:2
//I:0x0CABA34F D:212575055
//I:0x00000100 D:256
//I:0x0134B8D5 D:20232405
//I:0x00000003 D:3
//I:0x0C3BA9E3 D:205236707
//I:0x00000004 D:4
//I:0x00000002 D:2
//I:0x00000005 D:5
//I:0x00000019 D:25

*/

/*
static char buf[]=
"\x42\xB0\x9F\x30\x2F\x44\xB6\x1E\xF9\x02"
"\x42\xF6\x43\x86\x83\xB1\x37\x32\xAB\xAD\xEB\x3B\xE1\xB0\x0F\xC0\x23\x66\x2C"
"\xE6\x97\x9A\xA0\xB8\xC4\x17\x84\x88\xF5\x04"
;

*/

//
//real testing
// 3 ! -  42 sequences..


/*
static char buf[]=
"\x42\xB1\x26\x04\x5B\x71\x78\x53\xD7\xBC\xE7\x79\xBC\xC6\xC6\x2F\xD8\xA5\x3C"
"\x25\x4E\x83\x04\x58\x59\x54\x07\x59\x42\xB0\x9F\x30\x2F\x44\xB6\x1E\xF9\x02"
"\x42\xF6\x43\x86\x83\xB1\x37\x32\xAB\xAD\xEB\x3B\xE1\xB0\x0F\xC0\x23\x66\x2C"
"\xE6\x97\x9A\xA0\xB8\xC4\x17\x84\x88\xF5\x04"
;
(network stack, timestampt, port)
UNPACKED BYTES:
I: 0x0000002D
I: 0x303BE42F
I: 0x00003DD7
*/

/*
static char buf[]=
"\x42\xB0\x9F\x30\x2F\x44\xB6\x1E\xF9\x02"
"\x42\xF6\x43\x86\x83\xB1\x37\x32\xAB\xAD\xEB\x3B\xE1\xB0\x0F\xC0\x23\x66\x2C"
"\xE6\x97\x9A\xA0\xB8\xC4\x17\x84\x88\xF5\x04"
;
(clients online)
UNPACKED BYTES:
I: 0x00745D01
*/

/*
static char buf[]=
"\x42\xF6\x43\x86\x83\xB1\x37\x32\xAB\xAD\xEB\x3B\xE1\xB0\x0F\xC0\x23\x66\x2C"
"\xE6\x97\x9A\xA0\xB8\xC4\x17\x84\x88\xF5\x04"
;
(unknown.0c3b .. and 0139 not hosts, maybe 41 ?)
UNPACKED BYTES:
I: 0x00000002
I: 0x0DAE112A
I: 0x00000100
I: 0x0139343A
I: 0x00000003
I: 0x0C3BA9E3
I: 0x00000004
I: 0x00000002
I: 0x00000005
I: 0x00000022
*/

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


static char buf[]=
"\x42\xC3\xA0\x33\x12\x3C\x0C\x11\x09\xE1\x5C\xFA\x9A\x5D\x38\xDA"
"\x6D\x07\x6E\xDD\xD4\xB8\x76\x17\xA7\x33\x87\x25\x52\xBF\x31\x74"
"\xF0\x5B\xC0\x28\xA5\xE5\x06\x31\x6B\x10\xEE\xE1\x70\x25\xD4\xB2"
"\x2E\x6E\x44\xFE\x44\xC3\xD4\x8D\x9C\xB6\x95\xA1\x6F\xC3\xB6\x21"
"\xA0\xDC\x4B\xF8\xB9\x9B\xD1\x88\xC3\x64\x68\xFD\x41\x1F\x37\xC2"
"\xFD\x1F\x00\x4E\x17\xA4\x07\x4C\x80\x51\x53\x8B\xB4\x3A\x02\x80"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x98\x00\x00\x00\x01"
"\x5F\xAD\x39\x9A\xBA\x29\x65\x47\x6F\x0B\x92\x4C\x4B\xD4\xC9\xB0"
"\x3E\xA3\xF9\x73\xC2\x8B\x15\xAB\x40\x0E\xFF\xBF\xB4\xFC\xB2\x3C"
"\xD8\xB2\xA6\x13\x7E\xE0\xB8\xD1\x6A\x93\xD5\x98\x37\x4C\xCE\x3A"
"\x13\xDD\x68\x68\xFE\x8E\xEF\x25\x04\xD2\x34\x83\xA8\x0F\x0F\x96"
"\x08\xF3\x49\x91\xBD\xF4\x49\xC6\x0C\xF4\x71\xD1\x51\xA9\xD4\x24"
"\x02\x4B\xD1\x62\x5D\x4D\x27\xBB\xDD\x5F\x2E\x2F\x80\x66\xDD\xB4"
"\x5A\x83\x98\x19\xBC\x1C\xC4\x6A\x47\x82\xA1\x96\x1F\x09\xA8\xED"
"\x9D\x65\xD6\x43\xE3\xBC\x9D\x8B\x65\x68\x2B\xEF\x40\x88\x35\x2B"
"\xC9\xAB\x6B\x76\xE8\x12\x72\x33\x33\x55\x73\xE3\x58\x54\xFB\x9E"
"\xAF\x2D\x23\x3D\x30\xD8\x3A\x69\xCE\x18\x6F\x61\xDA\x4C\x4C\x09"
"\xBE\xFD\xBA\xD9\x6B\x3D\xD2\xFA\xF7\xB6\x21\x2F\x3C\x14\xC6\x18"
"\x60\xC5\xD7\x5E\x7F\x62\x7D\x2B\x04\x25\xFB\xD9\xE2\xCB\x9B\xC8"
"\x19\xDB\x11\x41\x8F\x6E\xD2\xB8\xB2\x96\xA3\xB8\x37\xBB\x62\xFA"
"\x70\xE0\x42\x65\xFF\x7C\x84\xFE\xA3\x28\x07\x18\x0C\x6A\xAC\x39"
"\xD0\xE6\xED\x0D\xFC\x7A\xAB\xF9\xB7\x70\x46\x95\x64\x14\xDD\x9C"
"\x71\x1E\x02\xFF\x0D\x24\x84\xE7\x23\x32\xB1\x3B\xD1\x97\x34\x2C"
"\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x20\x41\x05\x03\x00"
"\x6E\x69\x63\x6B\x6E\x69\x63\x6B\x38\x38\x38\x37\x00\x00\x03\x00"
"\x04\x01\x80\x01\xD8\x4A\x94\x68\x8F\xE5\xC4\x85\x4B\x68\x4F\x6F"
"\x96\xF7\x4B\x2E\x4A\xAF\x4F\xEA\x9E\x38\xE7\xBF\xCC\xA3\x8D\xC1"
"\x16\x2E\x67\x4A\x9C\x0A\x35\x74\x81\x1D\x1F\x28\x03\x68\x7D\x39"
"\x9B\x0A\x42\xED\x06\x3F\x75\xAE\x7E\x79\x14\xA9\xE3\x5A\x5F\xAE"
"\x60\x2C\x01\xEE\xBD\x89\xAF\xFF\xAE\xD6\xF3\x79\xC9\x48\x57\x18"
"\x82\xA7\x11\xD9\x39\x6D\x45\x35\xBA\x2A\x60\x70\xB1\x80\x57\x93"
"\x22\x77\xC0\x6B\xA9\x13\xBC\x41\x38\x5F\x2C\x33\xBD\x21\x14\x82"
"\x81\xFE\x88\x11\x7C\x66\x38\xF5\xD9\x40\xFB\x8E\x47\xF1\x05\xA0"
"\xE4\xF2\xE9\x95\x00\x04\xBA\xD5\xEA\x09\x05\x02\x41\x01\x00\x09"
"\xBA\xD5\xEA\x09\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05\x40\x10\x7F\xA6\xC5"
"\xCB\x3D\x70\xB0\xC4\xDC\x6A\xD0\xE5\x34\x88\x4D\x5D\x83\x19\x9C"
;







int main(int argc, char* argv[]){
	void *outbuf;
	unsigned int len;
	unsigned int i;

	unsigned int *b;

	outbuf=(unsigned int*)malloc(8192);



	len=unpack(buf,sizeof(buf)-1,outbuf);

	b=outbuf;


	printf("UNPACKED BYTES:\n");

	for(i=0;i<len;i++){
		printf("I: 0x%08X\n",b[i]);
	};



	return 0;

};
